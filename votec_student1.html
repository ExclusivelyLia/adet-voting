<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Current Vote Counts</title>
    <link href='https://fonts.googleapis.com/css?family=Poppins' rel='stylesheet'>
    <link rel="stylesheet" href="css/votec_student1.css">
    <script src="https://kit.fontawesome.com/84ccdc0b43.js" crossorigin="anonymous"></script>
</head>
    <body>
        <div class="container">
            <div class="title-bar">
                <div class="title-section">
                    <h2>Your Vote Counts!</h2>
                    <p>Hereâ€™s a Summary of Votes.</p>
                </div>
            </div>

            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>BSCS</th>
                            <th>BSIT</th>
                        </tr>
                    </thead>
                    <tbody id="candidatesTableBody">
                        <!-- This will be populated by JavaScript -->
                        
                    </tbody>
                </table>
            </div>
            <div class="action-button">
                <button type="button" class="viewDetails" onclick="window.location.href='votec_student2.html'"> 
                    View More Details <img src="pictures/halaman.png"></button>
            </div>
        </div>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                fetch('fetch_votes.php')
                    .then(response => response.json())
                    .then(data => {
                        const candidatesTableBody = document.getElementById('candidatesTableBody');
                        const voteCounts = {
                            'President': { BSCS: 0, BSIT: 0, total: 0 },
                            'Vice President': { BSCS: 0, BSIT: 0, total: 0 },
                            'Councilor': { BSCS: 0, BSIT: 0, total: 0 }
                        };
            
                        // Organize data into a more usable structure
                        data.votes.forEach(vote => {
                            if (vote.category in voteCounts) {
                                voteCounts[vote.category][vote.student_program] = vote.vote_count;
                                voteCounts[vote.category].total += vote.vote_count;
                            }
                        });
            
                        // Populate the table
                        for (const [category, counts] of Object.entries(voteCounts)) {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td>${category}</td>
                                <td>${counts.BSCS}</td>
                                <td>${counts.BSIT}</td>

                            `;
                            candidatesTableBody.appendChild(row);
                        }
            
                        // Update total votes count
                        const totalVotesRow = document.createElement('tr');
                        totalVotesRow.innerHTML = `
                            <td>Total Votes</td>
                            <td colspan="3">${data.total_votes}</td>
                        `;
                        candidatesTableBody.appendChild(totalVotesRow);
                    })
                    .catch(error => console.error('Error fetching vote data:', error));
            });
            </script>            
    </body>
</html>

